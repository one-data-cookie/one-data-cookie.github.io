---
layout: post
content-type: eg
title: "ChatMK Search Test"
permalink: /chatmk-test/
---

<div style="max-width: 800px; margin: 2rem auto; padding: 2rem;">
  <h1>ğŸ”§ DEBUG: Page is loading!</h1>
  <h2>ğŸ¤– ChatMK Search Test</h2>
  <p><strong>If you can see this text, the page is rendering correctly.</strong></p>
  
  <div style="margin: 2rem 0;">
    <input type="text" id="searchQuery" placeholder="Enter your search query..." 
           style="width: 70%; padding: 0.5rem; margin-right: 1rem;">
    <button onclick="performSearch()" style="padding: 0.5rem 1rem;">Search</button>
  </div>
  
  <div id="searchResults" style="margin-top: 2rem;"></div>
</div>

<!-- Load transformers.js for query embeddings -->
<script type="module">
  import { pipeline } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.2';
  window.transformers = { pipeline };
</script>

<script src="/assets/js/chatmk-search.js"></script>
<script>
console.log('ğŸ” ChatMK Test: Script loaded');
console.log('ğŸ” ChatMKSearch class available:', typeof ChatMKSearch);

// Initialize ChatMK search
const chatMKSearch = new ChatMKSearch();
console.log('ğŸ” ChatMK instance created:', chatMKSearch);

async function performSearch() {
  console.log('ğŸ” performSearch called');
  const query = document.getElementById('searchQuery').value.trim();
  console.log('ğŸ” Query:', query);
  if (!query) {
    console.log('ğŸ” Empty query, returning');
    return;
  }
  
  const resultsDiv = document.getElementById('searchResults');
  console.log('ğŸ” Results div found:', !!resultsDiv);
  resultsDiv.innerHTML = '<p>Searching...</p>';
  
  try {
    console.log('ğŸ” About to load ChatMK data...');
    // For now, use keyword search since we need to implement real query embeddings
    await chatMKSearch.loadChatMKData();
    console.log('ğŸ” Data loaded successfully');
    
    console.log('ğŸ” About to perform SEMANTIC VECTOR search...');
    const results = await chatMKSearch.search(query, 10);
    console.log('ğŸ” Semantic search results:', results);
    
    if (results.length === 0) {
      resultsDiv.innerHTML = '<p>No results found.</p>';
      return;
    }
    
    let html = `<h3>Found ${results.length} results:</h3>`;
    
    for (const result of results) {
      html += `
        <div style="border: 1px solid #ddd; padding: 1rem; margin: 1rem 0; border-radius: 4px;">
          <h4><a href="${result.url}">${result.title}</a></h4>
          <p><strong>Type:</strong> ${result.type}</p>
          <p><strong>Excerpt:</strong> ${result.excerpt}</p>
          <p><strong>Similarity Score:</strong> ${result.similarity.toFixed(3)}</p>
          ${result.tags ? `<p><strong>Tags:</strong> ${result.tags.join(', ')}</p>` : ''}
        </div>
      `;
    }
    
    resultsDiv.innerHTML = html;
    
  } catch (error) {
    console.error('Search error:', error);
    resultsDiv.innerHTML = '<p>Search failed. Check console for details.</p>';
  }
}

// Allow Enter key to trigger search
document.getElementById('searchQuery').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    performSearch();
  }
});
</script>
